C
C *** LAST REVISED ON 26-AUG-1994 21:46:31.74
C *** SOURCE FILE: [LONGLIB93.SOURCES.FORTRAN.3DLIB]DRAW3D.FOR
C
	SUBROUTINE DRAW3D(V1,V2,ID,DS)
C
C	CREATED: DGL 1-AUG-1984
C
C	PLOT A LINE FROM V1 TO V2 WITH PERSPECTIVE
C
C	V1,V2	(R):	LINE DEFINED BETWEEN TWO SCREEN COORDINATE POINTS
C	ID	(I):	PLOT CODE (2,9)
C	DS	(R):	PERSPECTIVE SCALE FACTOR (DS=0 NO PERSPECTIVE)
C
	DIMENSION V1(4),V2(4)
	COMMON /LAST3D/XS2,YS2,XS1,YS1
	SAVE /LAST3D/
	IF (DS.NE.0.0) THEN	! PERSPECTIVE
		IF (V1(3).EQ.0.0.OR.V2(3).EQ.0.0) THEN
			RETURN	! LINE THROUGH Ze PLANE
		ELSE
			XS1=(V1(1)/V1(3))	!/DS
			YS1=(V1(2)/V1(3))	!/DS
			CALL PLOT(XS1,YS1,3)
			XS2=(V2(1)/V2(3))	!/DS
			YS2=(V2(2)/V2(3))	!/DS
			CALL PLOT(XS2,YS2,ID)
C			CALL PLOT(XS2,YS2,3)
		ENDIF
	ELSE			! NO PERSPECTIVE
		XS1=V1(1)
		YS1=V1(2)
		CALL PLOT(XS1,YS1,3)
		XS2=V2(1)
		YS2=V2(2)
		CALL PLOT(XS2,YS2,ID)
C		CALL PLOT(XS2,YS2,3)
	ENDIF
	RETURN
	END
