C
C *** LAST REVISED ON  8-DEC-1993 01:48:43.11
C *** SOURCE FILE: [LONGLIB93.SOURCES.FORTRAN.AUXLIB]SYMBOL1.FOR
C
	SUBROUTINE SYMBOL1(XA,YA,HI,ASC,TH,NC,IPF)
C
C 	EXTENSIVELY REVISED: DGL  AUG 1987
C	AND AGAIN:		  JUNE 1990
C	IMPROVED LOWER CASE FONT, ADDED TEXT CONTINUE, ETC.
C	IF ASCII NULL ENCOUNTERED IN INPUT STRING BEYOND FIRST POSITION
C	ROUTINE TERMINATES.
C
C XA 	(R)	STARTING X-COORD. IF XA>998., END OF STRING OF LAST CALL USED
C YA 	(R)	STARTING Y-COORD. IF YA>998., END OF STRING OF LAST CALL USED
C HI 	(R)	HEIGHT OF CHARACTERS IN STRING
C ASC 	(A)	CHARACTER STRING TO PLOT
C TH 	(R)	ANGLE OF ORIENTATION IN DEGREES
C NC	(I)	NUMBER OF CHARACTERS
C		 > 0 NORMAL
C		 -1 PLOT ONLY SINGLE SYMBOL
C		 -2 PLOT LINE THEN SINGLE SYMBOL
C IPF 	(I)	LOCATION CONTROL.  STRING IS PLOTTED WITH (XA,YA) AT:
C		 -3 LOWER LEFT HAND CORNER, END POINTS OF STRING
C		    ARE RETURNED IN XA,YA, NO PLOTTING DONE
C		 -2 LOWER LEFT HAND CORNER, END POINTS OF STRING ARE
C		    RETURNED IN XA,YA.  STRING IS PLOTTED
C		 -1 LOWER LEFT HAND CORNER.  STRING PLOTTED
C		  0 CENTER
C		  1 LOWER RIGHT HAND CORNER
C		  2 NO PLOTTING
C
C	NOTE THAT CODING FOR THE 16 BIT VALUES ASSUMES 2'S COMPLEMENT
C	REPRESENTATION OF INTEGERS.
C
      CHARACTER*(*) ASC
      SAVE X,Y
      LOGICAL OUT
C
C	CHARACTER PLOTTING DATA
C
      INTEGER*2 SYM(128),STB(416)
      INTEGER*2 SYN1(8) ,SYN9(8), SYN17(8),SYN25(8),SYN33(8),
     $ SYN41(8),SYN49(8),SYN57(8),SYN65(8),SYN73(8),SYN81(8),
     $ SYN89(8),SYN97(8),SYN105(8),SYN113(8),SYN121(8)
      INTEGER*2 STC1(8) ,STC9(8), STC17(8),STC25(8),STC33(8),
     $ STC41(8),STC49(8),STC57(8),STC65(8),STC73(8),STC81(8),
     $ STC89(8),STC97(8),STC105(8),STC113(8),STC121(8),STC129(8),
     $ STC137(8),STC145(8),STC153(8),STC161(8),STC169(8),
     $ STC177(8),STC185(8),STC193(8),STC201(8),STC209(8)
      INTEGER*2 STC217(8),STC225(8),STC233(8),STC241(8),
     $ STC249(8),STC257(8),STC265(8),STC273(8),STC281(8),
     $ STC289(8),STC297(8),STC305(8),STC313(8),STC321(8),
     $ STC329(8),STC337(8),STC345(8),STC353(8),STC361(8),
     $ STC369(8),STC377(8),STC385(8),STC393(8),STC401(8),
     $ STC409(8)
      EQUIVALENCE (SYM(  1),SYN  1(1)),(SYM(  9),SYN  9(1))
      EQUIVALENCE (SYM( 17),SYN 17(1)),(SYM( 25),SYN 25(1))
      EQUIVALENCE (SYM( 33),SYN 33(1)),(SYM( 41),SYN 41(1))
      EQUIVALENCE (SYM( 49),SYN 49(1)),(SYM( 57),SYN 57(1))
      EQUIVALENCE (SYM( 65),SYN 65(1)),(SYM( 73),SYN 73(1))
      EQUIVALENCE (SYM( 81),SYN 81(1)),(SYM( 89),SYN 89(1))
      EQUIVALENCE (SYM( 97),SYN 97(1)),(SYM(105),SYN105(1))
      EQUIVALENCE (SYM(113),SYN113(1)),(SYM(121),SYN121(1))
      EQUIVALENCE (STB(  1),STC  1(1)),(STB(  9),STC  9(1))
      EQUIVALENCE (STB( 17),STC 17(1)),(STB( 25),STC 25(1))
      EQUIVALENCE (STB( 33),STC 33(1)),(STB( 41),STC 41(1))
      EQUIVALENCE (STB( 49),STC 49(1)),(STB( 57),STC 57(1))
      EQUIVALENCE (STB( 65),STC 65(1)),(STB( 73),STC 73(1))
      EQUIVALENCE (STB( 81),STC 81(1)),(STB( 89),STC 89(1))
      EQUIVALENCE (STB( 97),STC 97(1)),(STB(105),STC105(1))
      EQUIVALENCE (STB(113),STC113(1)),(STB(121),STC121(1))
      EQUIVALENCE (STB(129),STC129(1)),(STB(137),STC137(1))
      EQUIVALENCE (STB(145),STC145(1)),(STB(153),STC153(1))
      EQUIVALENCE (STB(161),STC161(1)),(STB(169),STC169(1))
      EQUIVALENCE (STB(177),STC177(1)),(STB(185),STC185(1))
      EQUIVALENCE (STB(193),STC193(1)),(STB(201),STC201(1))
      EQUIVALENCE (STB(209),STC209(1)),(STB(217),STC217(1))
      EQUIVALENCE (STB(225),STC225(1)),(STB(233),STC233(1))
      EQUIVALENCE (STB(241),STC241(1)),(STB(249),STC249(1))
      EQUIVALENCE (STB(257),STC257(1)),(STB(265),STC265(1))
      EQUIVALENCE (STB(273),STC273(1)),(STB(281),STC281(1))
      EQUIVALENCE (STB(289),STC289(1)),(STB(297),STC297(1))
      EQUIVALENCE (STB(305),STC305(1)),(STB(313),STC313(1))
      EQUIVALENCE (STB(321),STC321(1)),(STB(329),STC329(1))
      EQUIVALENCE (STB(337),STC337(1)),(STB(345),STC345(1))
      EQUIVALENCE (STB(353),STC353(1)),(STB(361),STC361(1))
      EQUIVALENCE (STB(369),STC369(1)),(STB(377),STC377(1))
      EQUIVALENCE (STB(385),STC385(1)),(STB(393),STC393(1))
      EQUIVALENCE (STB(401),STC401(1)),(STB(409),STC409(1))
      DATA SYN	1/     0,     8,    20,    26
     1,    31,	  36,	 43,	50/
      DATA SYN	9/    55,    62,    68,    82
     1,    91,	  98,	101,   104/
      DATA SYN 17/   111,   118,   125,   125
     1,   125,	 125,	125,   125/
      DATA SYN 25/   125,   125,   125,   125
     1,   125,	 125,	125,   125/
      DATA SYN 33/   125,   126,   136,   141
     1,   150,	 161,	174,   186/
      DATA SYN 41/   190,   195,   200,   207
     1,   212,	 215,	218,   221/
      DATA SYN 49/   223,   234,   240,   249
     1,   260,	 266,	276,   287/
      DATA SYN 57/   293,   311,   321,   326
     1,   332,	 336,	341,   345/
      DATA SYN 65/   354,   366,   373,   385
     1,   394,	 402,	409,   414/
      DATA SYN 73/   424,   430,   437,   443
     1,   448,	 452,	457,   463/
      DATA SYN 81/   473,   480,   492,   501
     1,   514,	 519,	526,   530/
      DATA SYN 89/   536,   544,   552,   559
     1,   564,	 567,	571,   577/
      DATA SYN 97/   583,   586,   597,   607
     1,   614,	 625,	635,   641/
      DATA SYN105/   654,   660,   668,   675
     1,   681,	 687,	697,   704/
      DATA SYN113/   714,   724,   735,   740
     1,   748,	 754,	762,   766/
      DATA SYN121/   772,   776,   785,   790
     1,   798,	 803,	811,   816/
      DATA STC	1/ 10842,  2088, 11276, -9686
     1, 10842,	8233,  2320,  5131/
      DATA STC	9/ 11044, -9686, 10842,  3080
     1, -9686,	2666,  7256, 18650/
      DATA STC 17/ 26668, -9716, 10842,  2584
     1, 10780, 23258, 10776,  6684/
      DATA STC 25/ -9718, 11336,  3112, 26842
     1,  2092, 22796, -9701, 10330/
      DATA STC 33/  6764, -9718, 11354,  8547
     1, 24872,	2065,  4945, 21260/
      DATA STC 41/ -9693, 11336,  3176, 10826
     1,  7256, 23258, 11304,  3080/
      DATA STC 49/ -9702, 10826, 22746, -9700
     1,  7256, 11368,  3144, 24794/
      DATA STC 57/ 20516, 18708, -9685, 10842
     1,  9057,	4945,-14630,   577/
      DATA STC 65/  2314, 20993, 12849,-14830
     1, 12641,	9075, 16838, 29489/
      DATA STC 73/ 24579, 21540,-14832,  2888
     1,  6932,	8217, 11305,   626/
      DATA STC 81/ 18630, 26924, 12328, 10545
     1,   836,	3083,-14844,   596/
      DATA STC 89/  2049,  8976, 12843,  6441
     1,-14844, 10849,-14798,  8563/
      DATA STC 97/   785, 29126,  4899,-14847
     1, 10826,	4196,  5216, 19142/
      DATA STC105/ 22570,-14820,  4361, 22726
     1,-14820,	 321, 13510, 18630/
      DATA STC113/ 12584, 11315,   780,  2049
     1,-14804,	 833, 12866,-14807/
      DATA STC121/ 12648, 11315,  2084,  1024
     1, 28870, 11316,  6938,  3092/
      DATA STC129/   259,-14840, 13123,  4120
     1,-14828,	 328,  3075,  8988/
      DATA STC137/ 12320,-14796,  7000,  3092
     1,   259,	8200, 13362, 28870/
      DATA STC145/ 11316,   273, 16838,  3075
     1,  6932,	8217, 12584, 11315/
      DATA STC153/  6948,  4185,   264,   710
     1, 11284, 12595,  8232,  7193/
      DATA STC161/ 16838, 20737,-14831,  2625
     1, 25106,-14814,  6211,-14797/
      DATA STC169/  5200,  8292, 16838, 12572
     1, 17094, 20994, 11300, 12595/
      DATA STC177/-14808,   323, 10248, 13105
     1,  5164,	6674,-14804, 12832/
      DATA STC185/  1060,  5200, 12486, 11315
     1,  6948, 23320,  3092,	 3/
      DATA STC193/ 27846, 12595,  2088,   769
     1,-14836,	3075, 13100, 28976/
      DATA STC201/-14847, 13360,  6235,  1088
     1, 12486, 23092,-14824, 13164/
      DATA STC209/ 10289,   264,  5124,-14829
     1, 22576, 29724,-14844,   833/
      DATA STC217/ 12866, 13169, 18630,   769
     1, 13324, 12486,  6260,-14844/
      DATA STC225/ 16432,-14844,  6704,  1076
     1, 12486,	3176,  1140, 18630/
      DATA STC233/   769, 11276, 12595,  2088
     1, 12486, 11315,  6948,-14824/
      DATA STC241/   328,  3075, 13100, 10289
     1, 21000,-14844, 13104,  9260/
      DATA STC249/  6171,  1114, 18630,   769
     1,  5132,	6427, 10272, 13105/
      DATA STC257/-14804, 13424,   626, 28870
     1,   264,	3075,-14796,   624/
      DATA STC265/-14796,   368,   794,-14796
     1, 11272, 28724,  3112,-14844/
      DATA STC273/ 10352,   538, 11380,-14822
     1, 13424,	2092,  1024, 29382/
      DATA STC281/    48,-15358, 12356,   710
     1, 12338, 22724,  7210,  2666/
      DATA STC289/ 19142, 10776,  7256, 28870
     1,-14821,	6216,  8737,   532/
      DATA STC297/  2049,  1124, 12486,  8784
     1,  7203,	 780,  4098, 25798/
      DATA STC305/  6177,   264,-14844,  1140
     1,  8788,	6177,	264,  5122/
      DATA STC313/ 20678,  7188,  8483,  2072
     1,   769, 17094, 13098,  7001/
      DATA STC321/ 16838,  3075, 25652, 12594
     1,  6184,	4625,-14812, 24624/
      DATA STC329/  7203,-14844,   833,  6722
     1, 27161,-14806,	577,  8971/
      DATA STC337/ 13171, 12486,  2156,  1114
     1, 16838, 16899, 12594,  8390/
      DATA STC345/  8536,   538,  9050,  1052
     1,  8390,	8536,  7203,-14844/
      DATA STC353/  6216,  8993,  3100,   259
     1,-14840, 24624, 13106,  7212/
      DATA STC361/  4627,-14816, 13380, 12900
     1, 10289,	4376,  9234,  8390/
      DATA STC369/  8784,-14812,  3075,  4371
     1,  8472,-14812,  9057,  2674/
      DATA STC377/-14845,  2144,   769, 25612
     1,-14844,	 608,-14812,   352/
      DATA STC385/   786,-14812, 24612,-14844
     1,   833, 13324,  6256,  5137/
      DATA STC393/ 24774,    36,-14844,  2370
     1,  6161, 10529,-15054,  4674/
      DATA STC401/ 12898, 16838,  4618,  8731
     1, 12586, 20677,  6937,-14812/
      DATA STC409/ 13360,     4, 28724,-14844
     1,     0,	   0,	  0,	 0/
	save I0
	data I0/0/
C       
	XA1=XA
	YA1=YA
	X0=0.
	Y0=0.
C
C	CONTINUE STRING OUTPUT FROM END OF LAST CALL TO SYMBOL
C
	IF (XA.GT.998.0) XA1=X
	IF (YA.GT.998.0) YA1=Y
	IPF2=IPF
C
	IF (IPF2) 1,2,3
3	X0=-IABS(NC)*HI
	GOTO 1
2	Y0=-HI/2.
	X0=-IABS(NC)*HI/2.
1	H=TH*0.0174532925
	SI=SIN(H)
	CO=COS(H)
	OUT=.TRUE.
	IF (IPF2.EQ.2) RETURN
	IF (IPF2.EQ.-3) THEN
		OUT=.FALSE.
		XX=X
		YY=Y
	ENDIF
	X=XA1+X0*CO-Y0*SI
	Y=YA1+Y0*CO+X0*SI
	H=HI/7.0
	IF (NC.NE.-2) GOTO 4
	IP=2
	IF (OUT) CALL PLOT(XA1,YA1,IP)
4	IP=3
	IF (OUT) CALL PLOT(X,Y,IP)
	IF (NC) 10,20,30
10	NC0=0
C
C	GET FIRST ASCII OR INTEGER VALUE
C
	JCH=ICHAR(ASC(1:1))
	GOTO 50
20	CONTINUE
	IF (NC.EQ.-2.AND.OUT) CALL PLOT(XA1,YA1,2)
	IF (IPF2.LT.-1) THEN
		XA=X
		YA=Y
	ENDIF
	RETURN
30	NC0=NC
	I0=0
40	NC0=NC0-1
	IF (NC0.LT.0) GOTO 20
	I0=1+I0
C
	JCH=ICHAR(ASC(I0:I0))
C
C	TERMINATE ROUTINE IF ASCII NULL ENCOUNTERED
C
	IF (JCH.EQ.0.AND.I0.GT.1) GOTO 20
50	IF (JCH.LT.0.OR.JCH.GE.128) JCH=32
	I3=SYM(1+JCH)
	IF (JCH.GE.32) GOTO 55
	IP=3
	I1=0
	X=X+H*(-2.*CO+3.*SI)
	Y=Y+H*(-3.*CO-2.*SI)
	XW1=X
	YW1=Y
	XW2=X
	YW2=Y
	GOTO 110
55	IF (JCH.NE.112) GOTO 60
	XW2=X+H*2.*SI
	YW2=Y-H*2.*CO
	IF (OUT) CALL PLOT(XW2,YW2,3)
60	IP=2
	I3=1+I3
C
C	DECODE CHARACTER DATA
C
	I4=(I3-1)/2+1
	IV=STB(I4)
	I4=MOD(I3-1,2)*8
	I1=IBITS(IV,I4,8)
C
	I2=MOD(I1,64)
	IF (I1.GE.64) IP=3
	IY=I2/8
	IX=I2-8*IY
	X1=IX
	Y1=IY
	XW1=X+H*(X1*CO-Y1*SI)
	YW1=Y+H*(Y1*CO+X1*SI)
	XW2=XW1
	YW2=YW1
	IF ((JCH.EQ.103.OR.JCH.EQ.112.OR.JCH.EQ.113.OR.
     $		JCH.EQ.121).AND.(I1.LT.192)) THEN
		XW2=XW2+H*2.*SI
		YW2=YW2-H*2.*CO
	ENDIF
110	IF (OUT) THEN
	  CALL PLOT(XW2,YW2,IP)
C MAKE PERIOD SLIGHTLY LARGER THAN ONE POINT
	  IF (JCH.EQ.46.AND.IP.EQ.2) CALL PLOT(XW2+0.0026,YW2,IP)
	ENDIF
	IF (I1.LT.192) GOTO 60
	X=XW1
	Y=YW1
	GOTO 40
	END
