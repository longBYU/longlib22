C
C
	SUBROUTINE LGAXS(X0,Y0,A0,N0,S0,T0,C0,D0,ICOL)
C
C	THIS ROUTINE PLOTS A LOG AXIS WITH EXPONENT LABELING
C	MODIFIED FROM AXIS D.LONG 22-OCT-83	AT JPL
C
C	X0	X COORDINATE OF START OF AXIS
C	Y0	Y COORDINATE OF START OF AXIS
C	A0	CHARACTER STRING TO DESCRIBE AXIS
C	N0	NUMBER OF CHARACTERS IN STRING
C		- ON CLOCKWISE SIDE OF AXIS (NORMAL FOR X)
C		+ ON COUNTER CLOCKWISE SIDE OF AXIS (NORMAL FOR Y)
C		HUNDREDS DIGIT	   = 1 TICKS AND LINE ONLY--NO LABELING
C		THOUSANDS DIGIT    = 1 HORIZONTAL NUMBERS IN Y AXIS LABEL
C		100 THOUSANDS DIGIT = 1 USE COLOR ARRAY
C	S0	LENGTH OF AXIS
C		< 0	TICKS ON OPPOSITE SIDE OF AXIS FROM LABEL
C		= 0	NO ACTION (DUMMY CALL)
C		> 0	TICKS ON SAME SIDE AS AXIS LABEL (NORMAL)
C	T0	ANGLE OF AXIS TO X AXIS OF PAPER
C		0.0 FOR X-AXIS
C		90.0 FOR Y-AXIS
C	C0	COORDINATE OF MINIMUM TICK ON AXIS
C	D0	SCALING FACTOR EXPONENT OF THE FORM (NMAX-NMIN)/LENGTH
C	ICOL	COLOR ARRAY (NEEDED ONLY IF MAG(NO)>=10000)
C		ICOL(1) AXIS COLOR
C		ICOL(2) NUMBERS COLOR
C		ICOL(3) TITLE COLOR (RETURN)
C
	CHARACTER*(*) A0
	INTEGER ICOL(3)
	LOGICAL LABELS,COLOR
	DATA CS/.15/		! CHARACTER SIZE
	N1=IABS(N0)
	LABELS=.TRUE.
	HOR=T0
	IF (S0.EQ.0.0) RETURN
	T5=0.1			! TICK LENGTH
	B7=T5+.08		! NUMBER DISTANCE FROM AXIS
	B6=B7
	B8=0.0
	IF(N0.LT.0)GOTO 10
	B3=CS*4.
	B4=CS+0.08
	T2=T0
	GOTO 20
10	B3=-CS*4.
	B4=-T5-CS-.05
	T2=T0
	T5=-T5
20	CONTINUE
	COLOR=.FALSE.
	IF (N1.GE.100000) THEN
		N1=MOD(N1,100000)
		COLOR=.TRUE.
	ENDIF
	IF (N1.GE.10000) N1=MOD(N1,10000)
	IF (N1.GE.1000)THEN
		N1=MOD(N1,1000)
		HOR=0.0
		B4=(ABS(T5)+.05)*SIGN(1.,FLOAT(N0))
		IF (N0.GT.0) B4=B4+3.5*CS
		B6=.5*CS
		B8=(.5*CS+ABS(T5))*SIGN(1.,FLOAT(N0))
		IF (N0.LT.0) B8=B8-CS*1.6
	ENDIF
	IF (N1.GE.100) THEN
		N1=MOD(N1,100)
		LABELS=.FALSE.
	ENDIF
	N2=int(ABS(S0*D0)+.5)				! NUMBER OF TICKS
	XL=ABS(S0)/FLOAT(N2)				! DISTANCE BETWEEN TICKS
	T1=T0*0.017453294
	T3=COS(T1)
	T4=SIN(T1)
	HT3=COS(HOR*.017453294)
	HT4=SIN(HOR*.017453294)
	T6=T5*T3
	T5=T5*T4
C
	IF (COLOR) CALL PLOT(FLOAT(ICOL(1)),0.,0)	!COLOR
	S5=SIGN(1.,S0)*T5
	S6=SIGN(1.,S0)*T6
	X1=X0
	Y1=Y0
	CALL PLOT(X1,Y1,3)
	DO 100 I=1,N2			! PLOT MAJOR TICKS
	DO 100 J=2,10			! PLOT MINOR TICKS
	AT=.6
	IF (J.EQ.2) AT=1.
	X2=X1-S5*AT
	Y2=Y1+S6*AT
	CALL PLOT(X2,Y2,3)
	CALL PLOT(X1,Y1,2)
	AJ=ALOG10(FLOAT(J))-ALOG10(FLOAT(J-1))
	X1=X1+T3*XL*AJ
	Y1=Y1+T4*XL*AJ
	IF (T0.EQ.90.) X1=X0
	CALL PLOT(X1,Y1,2)
100	CONTINUE
	X2=X1-S5
	Y2=Y1+S6
	CALL PLOT(X2,Y2,2)
C
	IF (COLOR) CALL PLOT(FLOAT(ICOL(3)),0.,0)	!COLOR
	IF (.NOT.LABELS) RETURN
	C1=AINT(C0)
	X2=X0-B4*T4-B7*T3		! LOCATE CENTER NUMBER LABELS
	Y2=Y0+B4*T3-B6*T4
	N2=N2+1
	IF (COLOR) CALL PLOT(FLOAT(ICOL(2)),0.,0)	!COLOR
	DO 150 I=1,N2
		CALL SYMBOL(X2,Y2,CS,'10',HOR,2,-1)
		X1=X2-.6*CS*HT4+CS*2.*HT3
		Y1=Y2+.6*CS*HT3+CS*2.*HT4
		IF (C1.EQ.0.0) THEN
		    CALL SYMBOL(X1,Y1,CS*.8,'0',HOR,1,-1)
		ELSE
		    CALL NUMBER(X1,Y1,CS*.8,C1,HOR,0.0,-1)
		ENDIF
		C1=C1+SIGN(1.,D0)
		X2=X2+T3*XL
		Y2=Y2+T4*XL
150	CONTINUE
	IF (N1.LT.1) GOTO 155
	X1=0.0
	Y1=0.0
	CALL SYMBOL(X1,Y1,CS,A0,T2,N1,-3)	! GET TITLE LENGTH
	B1=0.5*(ABS(S0)-X1)
	X2=X0+B1*T3-B3*T4-B8*T4
	Y2=Y0+B1*T4+B3*T3
	IF (COLOR) CALL PLOT(FLOAT(ICOL(3)),0.,0)	!COLOR
	CALL SYMBOL(X2,Y2,CS,A0,T2,N1,-1)
155	RETURN
	END
