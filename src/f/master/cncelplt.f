C
C *** LAST REVISED ON  8-DEC-1993 07:03:25.89
C *** SOURCE FILE: [LONGLIB93.SOURCES.FORTRAN.MASTER]MLIB.FOR
C
	SUBROUTINE CNCELPLT(X1,Y1,X2,Y2,TV,V1,V2,V3,V4,V5,V6,V7,V8)
C
C	CREATED BY D. LONG     NOV, 1983	AT JPL
C	SUBPROGRAM OF CNTRPLT
C	COMPUTES AND PLOTS CELL SECTIONED CONTOURS
C
C	POINT ID MAP:
C			  (2)
C			2.   3.
C		    (1)	       (4)
C			1.   4.
C			  (8)
C
	INTEGER SEGCODE
C
	IF=SEGCODE(Y1,Y2,V1,V2,TV,YI1)
	IF=IF+2*SEGCODE(X1,X2,V2,V3,TV,XI2)
	IF=IF+4*SEGCODE(Y2,Y1,V3,V4,TV,YI3)
	IF=IF+8*SEGCODE(X2,X1,V4,V1,TV,XI4)
C
	GOTO (50,50,50,103,50,105,106,107,50,109,110,
     $		111,112,113,114,115) IF+1
	GOTO 50
103	CONTINUE
	CALL PLOT(X1,YI1,3)
	CALL PLOT(XI2,Y2,2)
	GOTO 50
105	CONTINUE
	CALL PLOT(X1,YI1,3)
	CALL PLOT(X2,YI3,2)
	GOTO 50
106	CONTINUE
	CALL PLOT(XI2,Y2,3)
	CALL PLOT(X2,YI3,2)
	GOTO 50
107	CONTINUE
	IF (V3.EQ.TV) GOTO 103
	GOTO 106
109	CONTINUE
	CALL PLOT(X1,YI1,3)
	CALL PLOT(XI4,Y1,2)
	GOTO 50
110	CONTINUE
	CALL PLOT(XI4,Y1,3)
	CALL PLOT(XI2,Y2,2)
	GOTO 50
111	CONTINUE
	IF (V1.EQ.TV) GOTO 103
	GOTO 109
112	CONTINUE
	CALL PLOT(XI4,Y1,3)
	CALL PLOT(X2,YI3,2)
	GOTO 50
113	CONTINUE
	IF (V1.EQ.TV) GOTO 112
	GOTO 109
114	CONTINUE
	IF (V3.EQ.TV) GOTO 112
	GOTO 106
115	CONTINUE
	IF (V1.EQ.TV) GOTO 50
	C1=POLY1INT(V5,V1,V3,V7,1.5)
	C2=POLY1INT(V6,V2,V4,V8,1.5)
	C=(C1+C2)/2.
	IF (C.GT.TV) THEN
		IF (V1.GT.TV) THEN
			CALL PLOT(X1,YI1,3)
			CALL PLOT(XI2,Y2,2)
			GOTO 112
		ELSE
			CALL PLOT(X1,YI1,3)
			CALL PLOT(XI4,Y1,2)
			GOTO 106
		ENDIF
	ELSE
		IF (V1.LT.TV) THEN
			CALL PLOT(X1,YI1,3)
			CALL PLOT(XI2,Y2,2)
			GOTO 112
		ELSE
			CALL PLOT(X1,YI1,3)
			CALL PLOT(XI4,Y1,2)
			GOTO 106
		ENDIF
	ENDIF
 50	RETURN
	END
C
	INTEGER FUNCTION SEGCODE(X1,X2,V1,V2,TV,X0)
C
C	CREATED BY D. LONG  NOV, 1983 	AT JPL
C	SUBFUNCTION OF CNTRPLT
C	DETERMINES IF INTERSECTION AND COMPUTES LOCATION
C
	integer SC
	SC=0
	IF (MAX(V1,V2).GE.TV.AND.MIN(V1,V2).LE.TV) THEN
		SC=1
		IF (V2.NE.V1) THEN
			X0=(X2-X1)*(TV-V1)/(V2-V1)+X1
		ELSE
			X0=X1
		ENDIF
	ENDIF
	SEGCODE=SC
	RETURN
	END
C
	REAL FUNCTION POLY1INT(V0,V1,V2,V3,D)
C
C	CREATED BY D. LONG     NOV, 1983	AT JPL
C	SUBFUNCTION OF CNTRPLT
C	DOES LEAST SQUARES CURVE INTERPLOATION
C	V0..V3 ASSUMMED EQUALLY SPACED AND 1.0 DISTANCE
C	D IS POINT OF INTERPOLATED VALUE
C
	C0= 0.95*V0+0.15*V1-0.15*V2+0.05*V3
	C1=-1.05*V0+0.65*V1+0.85*V2-0.45*V3
	C2= 0.25*V0-0.25*V1-0.25*V2+0.25*V3
C
	POLY1INT=C0+C1*D+C2*D**2
	RETURN
	END
